<!DOCTYPE html>
<html lang="pt-br">

    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- As 3 meta tags acima *devem* vir em primeiro lugar dentro do `head`; qualquer outro conteúdo deve vir *após* essas tags -->

        <!-- Bootstrap -->
        <link href="assets/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet">

        <link rel="stylesheet" href="assets/css/estilo.css">
        <link rel="stylesheet" href="assets/css/toggle.css">
        <link rel="stylesheet" href="assets/css/lista-categorias.css">
    </head>

    <body>
        <!-- CADASTRO CAT -->
        <div class="panel collapse" id="cadastro">
            <div class="panel-heading text-center">
                <h1>Nova Categoria</h1>
            </div>

            <div class="panel-body">
                <form id="cadastrarCategoria">
                    <div class="row">
                        <div class="col-xs-12 form-group">
                            <label class="control-label" for="nome">Nome: </label>
                            <input class="form-control" required id="nome">
                        </div>

                        <div class="col-xs-12 form-group">
                            <label class="control-label" for="exemplosComentario">Exemplos Comentario Pedido: </label>
                            <input class="form-control" required id="exemplosComentario" placeholder="Sem salada, sem bacon, sem sal, temperatura ambiente">
                        </div>

                        <div class="col-xs-12 form-group">
                            <label class="control-label" for="ordemExibicao">Ordem de Exibição no Menu: </label>
                            <input class="form-control" required id="ordemExibicao" type="number" min="0">
                        </div>

                        <div class="col-xs-12 form-group">
                            <label for="checkFazEntrega">Realiza Entrega? </label><br>

                            <label class="custom-check">
                                <input type="checkbox" name="onOff" id="checkFazEntrega">
                                <i></i> 
                                <span></span>
                            </label>
                        </div>
                    </div>

                    <div id="regrasEntregaCadastro" style="display: none;">
                        <div class="row">
                            <div class="col-xs-12">
                                <h3>Regras de Entrega: </h3>
                            </div>


                            <div class="col-xs-4 form-group">
                                <label for="checkQuatidade">Por quantidade: </label><br>

                                <label class="custom-check">
                                    <input type="checkbox" name="onOff" id="checkQuatidade">
                                    <i></i> 
                                    <span></span>
                                </label>
                            </div>

                            <div class="col-xs-8 form-group">
                                <label class="control-label" for="qtdMinima">Quantidade mínima para entrega:</label>
                                <input class="form-control" type="number" required disabled min="1" step="1" id="qtdMinima">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-xs-4 form-group">
                                <label for="checkOutrasCategorias">Precisa Pedir de outras Categorias: </label><br>

                                <label class="custom-check">
                                    <input type="checkbox" name="onOff" id="checkOutrasCategorias">
                                    <i></i> 
                                    <span></span>
                                </label>
                            </div>

                            <div class="col-xs-8 form-group">
                                <label for="outrasCategorias">Categorias: </label>
                                <select class="form-control" disabled multiple id="outrasCategorias">
                                    <option value="1">Pizzas</option>
                                    <option value="2">Lanches</option>
                                    <option value="3">Porções</option>
                                    <option value="4">Bebidas</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="col-xs-12 text-center">
                        <button type="reset" class="btn btn-primary">Limpar Campos</button>
                        <button type="submit" class="btn btn-success">Salvar</button>
                    </div>

                </form>
            </div>
        </div>

        <!-- CADASTRO SUBCAT -->
        <div class="panel collapse" id="cadastro-subcat">
            <div class="panel-heading text-center">
                <h1>Nova Subcategoria</h1>
            </div>

            <div class="panel-body">
                <form id="cadastrarSubcategoria">
                    <div class="row">
                        <div class="col-xs-12 form-group">
                            <label class="control-label" for="nomeSubCat">Nome: </label>
                            <input class="form-control" required id="nomeSubCat">
                        </div>

                        <div class="col-xs-12 form-group">
                            <label class="control-label" for="exemplosComentarioSubCat">Exemplos Comentario Pedido: </label>
                            <input class="form-control" required id="exemplosComentarioSubCat" placeholder="Sem salada, sem bacon, sem sal, temperatura ambiente">
                        </div>

                        <div class="col-xs-12 form-group">
                            <label for="checkFazEntregaSubCat">Realiza Entrega? </label><br>

                            <label class="custom-check">
                                <input type="checkbox" name="onOff" id="checkFazEntregaSubCat">
                                <i></i> 
                                <span></span>
                            </label>
                        </div>

                        <div class="col-xs-12 text-center">
                            <button type="reset" class="btn btn-primary">Limpar Campos</button>
                            <button type="button" id="cancelarAddSubCat" onclick="java.atual.cancelarAddSubCat();" class="btn btn-danger hide">Cancelar</button>
                            <button type="submit" class="btn btn-success">Salvar</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- EDIT -->
        <div class="panel collapse" id="editar-cat">
            <div class="panel-heading text-center">
                <h1>Editar Categoria</h1>
            </div>

            <div class="panel-body">
                <form id="form-editar-cat">
                    <div class="row">
                        <div class="col-xs-12 form-group">
                            <label class="control-label" for="nomeAlterarCategoria">Nome: </label>
                            <input class="form-control" required id="nomeAlterarCategoria">
                        </div>

                        <div class="col-xs-12 form-group">
                            <label class="control-label" for="exemplosComentarioAlterar">Exemplos Comentario Pedido: </label>
                            <input class="form-control" required id="exemplosComentarioAlterar" placeholder="Sem salada, sem bacon, sem sal, temperatura ambiente">
                        </div>

                        <div data-only-root="true">
                            <div class="col-xs-12 form-group">
                                <label class="control-label" for="ordemExibicaoEdit">Ordem de Exibição no Menu: </label>
                                <input class="form-control" required id="ordemExibicaoEdit" type="number" min="0">
                            </div>
                        </div>

                        <div class="col-xs-12 form-group">
                            <label for="checkFazEntregaEdit">Realiza Entrega? </label><br>

                            <label class="custom-check">
                                <input type="checkbox" name="onOff" id="checkFazEntregaEdit">
                                <i></i> 
                                <span></span>
                            </label>
                        </div>

                        <div data-only-root="true">
                            <div id="regrasEntregaCadastroEdit" style="display: none;">
                                <div class="col-xs-12">
                                    <h3>Regras de Entrega: </h3>
                                </div>

                                <div class="row">
                                    <div class="col-xs-4 form-group">
                                        <label for="checkQuatidadeEdit">Por quantidade: </label><br>

                                        <label class="custom-check">
                                            <input type="checkbox" name="onOff" id="checkQuatidadeEdit">
                                            <i></i> 
                                            <span></span>
                                        </label>
                                    </div>

                                    <div class="col-xs-8 form-group">
                                        <label class="control-label" for="qtdMinimaEdit">Quantidade mínima para entrega:</label>
                                        <input class="form-control" type="number" required disabled min="1" step="1" id="qtdMinimaEdit">
                                    </div>
                                </div>


                                <div class="row">
                                    <div class="col-xs-4 form-group">
                                        <label for="checkOutrasCategoriasEdit">Precisa Pedir de outras Categorias: </label><br>

                                        <label class="custom-check">
                                            <input type="checkbox" name="onOff" id="checkOutrasCategoriasEdit">
                                            <i></i> 
                                            <span></span>
                                        </label>
                                    </div>

                                    <div class="col-xs-8 form-group">
                                        <label for="outrasCategoriasEdit">Categorias: </label>
                                        <select class="form-control" disabled multiple id="outrasCategoriasEdit">
                                            <option value="1">Pizzas</option>
                                            <option value="2">Lanches</option>
                                            <option value="3">Porções</option>
                                            <option value="4">Bebidas</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-12 text-center">
                            <button type="reset" class="btn btn-primary">Limpar Campos</button>
                            <button type="button" id="cancelarEdicao" onclick="java.atual.cancelarAlteracao();" class="btn btn-danger hide">Cancelar Edição</button>
                            <button type="submit" class="btn btn-success">Salvar</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- LISTA -->
        <div class="panel">
            <div class="panel-heading text-center">
                <h1>Lista de Categorias</h1>
            </div>

            <div class="panel-body">
                <div class="form-group">
                    <button class="btn btn-primary" data-toggle="collapse" data-target="#cadastro">Nova Categoria</button>
                </div>

                <div class="row cat">
                    <!-- CATEGORIA -->
                    <div class="col-xs-12 card">
                        <div class="dropdown">
                            <!-- Drop Button -->
                            <h3 class="cat-0" data-toggle="dropdown">
                                <span class="nome-cat">Bebidas</span>
                                <span class="caret"></span>
                                <span class="glyphicon glyphicon-eye-close"></span>
                            </h3>

                            <!-- Drop Menu -->
                            <ul class="dropdown-menu">
                                <li class="list-group-item list-group-item-success">Produtos</li>
                                <li class="list-group-item list-group-item-info">Adicionais</li>
                                <li class="list-group-item list-group-item-primary" data-toggle="collapse" data-target="#cadastro-subcat">Nova Subcategoria</li>
                                <li class="list-group-item list-group-item-info">Tornar Visível</li>
                                <li class="list-group-item list-group-item-warning" onclick="abrirFormEdit()">Editar</li>
                                <li class="list-group-item list-group-item-danger">Remover</li>
                            </ul>
                        </div>
                    </div>

                    <!-- CATEGORIA -->
                    <div class="col-xs-12 card">
                        <div class="dropdown">
                            <!-- Drop Button -->
                            <h4 class="cat-1" id="drop-bebidas" data-toggle="dropdown">
                                <span class="nome-cat">Sucos</span>
                                <span class="caret"></span>
                                <span class="glyphicon glyphicon-eye-open"></span>
                            </h4>

                            <!-- Drop Menu -->
                            <ul class="dropdown-menu">
                                <li class="list-group-item list-group-item-success">Produtos</li>
                                <li class="list-group-item list-group-item-info">Adicionais</li>
                                <li class="list-group-item list-group-item-primary" data-toggle="collapse" data-target="#cadastro-subcat">Nova Subcategoria</li>
                                <li class="list-group-item list-group-item-info">Tornar Visível</li>
                                <li class="list-group-item list-group-item-warning" onclick="abrirFormEdit()">Editar</li>
                                <li class="list-group-item list-group-item-danger">Remover</li>
                            </ul>
                        </div>
                    </div>

                    <!-- CATEGORIA -->
                    <div class="col-xs-12 card">
                        <div class="dropdown">
                            <!-- Drop Button -->
                            <h4 class="cat-2" id="drop-bebidas" data-toggle="dropdown">
                                <span class="nome-cat">Naturais</span>
                                <span class="caret"></span>
                                <span class="glyphicon glyphicon-eye-open"></span>
                            </h4>

                            <!-- Drop Menu -->
                            <ul class="dropdown-menu">
                                <li class="list-group-item list-group-item-success">Produtos</li>
                                <li class="list-group-item list-group-item-info">Adicionais</li>
                                <li class="list-group-item list-group-item-primary" data-toggle="collapse" data-target="#cadastro-subcat">Nova Subcategoria</li>
                                <li class="list-group-item list-group-item-info">Tornar Visível</li>
                                <li class="list-group-item list-group-item-warning" onclick="abrirFormEdit()">Editar</li>
                                <li class="list-group-item list-group-item-danger">Remover</li>
                            </ul>
                        </div>
                    </div>

                    <!-- CATEGORIA -->
                    <div class="col-xs-12 card">
                        <div class="dropdown">
                            <!-- Drop Button -->
                            <h4 class="cat-2" id="drop-bebidas" data-toggle="dropdown">
                                <span class="nome-cat">Ao Leite</span>
                                <span class="caret"></span>
                                <span class="glyphicon glyphicon-eye-open"></span>
                            </h4>

                            <!-- Drop Menu -->
                            <ul class="dropdown-menu">
                                <li class="list-group-item list-group-item-success">Produtos</li>
                                <li class="list-group-item list-group-item-info">Adicionais</li>
                                <li class="list-group-item list-group-item-primary" data-toggle="collapse" data-target="#cadastro-subcat">Nova Subcategoria</li>
                                <li class="list-group-item list-group-item-info">Tornar Visível</li>
                                <li class="list-group-item list-group-item-warning" onclick="abrirFormEdit()">Editar</li>
                                <li class="list-group-item list-group-item-danger">Remover</li>
                            </ul>
                        </div>
                    </div>

                    <!-- CATEGORIA -->
                    <div class="col-xs-12 card">
                        <div class="dropdown">
                            <!-- Drop Button -->
                            <h4 class="cat-1" id="drop-bebidas" data-toggle="dropdown">
                                <span class="nome-cat">Cervejas</span>
                                <span class="caret"></span>
                                <span class="glyphicon glyphicon-eye-open"></span>
                            </h4>

                            <!-- Drop Menu -->
                            <ul class="dropdown-menu">
                                <li class="list-group-item list-group-item-success">Produtos</li>
                                <li class="list-group-item list-group-item-info">Adicionais</li>
                                <li class="list-group-item list-group-item-primary" data-toggle="collapse" data-target="#cadastro-subcat">Nova Subcategoria</li>
                                <li class="list-group-item list-group-item-info">Tornar Visível</li>
                                <li class="list-group-item list-group-item-warning" onclick="abrirFormEdit()">Editar</li>
                                <li class="list-group-item list-group-item-danger">Remover</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="row cat">
                    <!-- CATEGORIA -->
                    <div class="col-xs-12 card">
                        <div class="dropdown">
                            <!-- Drop Button -->
                            <h3 class="cat-0" data-toggle="dropdown">
                                <span class="nome-cat">Lanches</span>
                                <span class="caret"></span>
                                <span class="glyphicon glyphicon-eye-close"></span>
                            </h3>

                            <!-- Drop Menu -->
                            <ul class="dropdown-menu">
                                <li class="list-group-item list-group-item-success">Produtos</li>
                                <li class="list-group-item list-group-item-info">Adicionais</li>
                                <li class="list-group-item list-group-item-primary" data-toggle="collapse" data-target="#cadastro-subcat">Nova Subcategoria</li>
                                <li class="list-group-item list-group-item-info">Tornar Visível</li>
                                <li class="list-group-item list-group-item-warning" onclick="abrirFormEdit()">Editar</li>
                                <li class="list-group-item list-group-item-danger">Remover</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- jQuery (obrigatório para plugins JavaScript do Bootstrap) -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <!-- Inclui todos os plugins compilados (abaixo), ou inclua arquivos separadados se necessário -->
        <script src="assets/bootstrap-3.3.7/js/bootstrap.min.js"></script>

        <script type="text/javascript">
            $("#cadastrarCategoria").submit(function (event) {
                event.preventDefault();
                var categoria = {
                    nome: $("#nome").val(),
                    exemplosComentario: $("#exemplosComentario").val(),
                    fazEntrega: $("#checkFazEntrega").is(":checked"),
                    qtdMinEntrega: $('#checkQuatidade').is(":checked") ? parseInt($("#qtdMinima").val()) : 1,
                    ordemExibicao: parseInt($("#ordemExibicao").val()),
                    outrasCategorias: $("#checkOutrasCategorias").is(":checked") ? $("#outrasCategorias").val() : [],
                    precisaPedirOutraCategoria: $("#checkOutrasCategorias").is(":checked")
                };
                var resultado = java.atual.realizarCadastro(categoria);
                if (resultado === true) {
                    $(this)[0].reset();
                }
            });

            $('#cadastrarCategoria').on('reset', function (e) {
                $("#nome").focus();
            });

            $("#form-editar-cat").submit(function (event) {
                event.preventDefault();
                var categoria = {
                    nome: $("#nomeAlterarCategoria").val(),
                    exemplosComentario: $("#exemplosComentarioAlterar").val(),
                    fazEntrega: $("#checkFazEntregaEdit").is(":checked"),
                    qtdMinEntrega: $('#checkQuatidadeEdit').is(":checked") ? parseInt($("#qtdMinimaEdit").val()) : 1,
                    ordemExibicao: parseInt($("#ordemExibicaoEdit").val()),
                    outrasCategorias: $("#checkOutrasCategoriasEdit").is(":checked") ? $("#outrasCategoriasEdit").val() : [],
                    precisaPedirOutraCategoria: $("#checkOutrasCategoriasEdit").is(":checked")
                };
                var resultado = java.atual.realizarCadastro(categoria);
                if (resultado === true) {
                    $(this)[0].reset();
                }
            });

            $('#form-editar-cat').on('reset', function (e) {
                $("#nomeAlterarCategoria").focus();
            });

            $("#cadastrarSubcategoria").submit(function (event) {
                event.preventDefault();
                var categoria = {
                    nome: $("#nomeSubCat").val(),
                    exemplosComentario: $("#exemplosComentarioSubCat").val(),
                    fazEntrega: $("#checkFazEntregaSubCat").is(":checked")
                };
                var resultado = java.atual.realizarCadastroSub(categoria);
                if (resultado === true) {
                    $(this)[0].reset();
                }
            });

            $('#cadastrarSubcategoria').on('reset', function (e) {
                $("#nomeAlterarCategoria").focus();
            });

            $("#checkFazEntrega").change(e => {
                if ($("#checkFazEntrega").is(":checked")) {
                    $("#regrasEntregaCadastro").slideDown();
                } else {
                    $("#regrasEntregaCadastro").slideUp();
                }
            });

            $('#checkQuatidade').change(function (event) {
                $('#qtdMinima').prop("disabled", !$(this).is(":checked"));
            });

            $("#checkFazEntregaSubCat").change(e => {
                if ($("#checkFazEntregaSubCat").is(":checked")) {
                    $("#regrasEntregaCadastroSubCat").slideDown();
                } else {
                    $("#regrasEntregaCadastroSubCat").slideUp();
                }
            });

            $('#checkQuatidadeSubCat').change(function (event) {
                $('#qtdMinimaSubCat').prop("disabled", !$(this).is(":checked"));
            });

            $("#checkFazEntregaEdit").change(e => {
                if ($("#checkFazEntregaEdit").is(":checked")) {
                    $("#regrasEntregaCadastroEdit").slideDown();
                } else {
                    $("#regrasEntregaCadastroEdit").slideUp();
                }
            });

            $('#checkQuatidadeEdit').change(function (event) {
                $('#qtdMinimaEdit').prop("disabled", !$(this).is(":checked"));
            });

            $('#checkOutrasCategorias').change(function (event) {
                $('#outrasCategorias').prop("disabled", !$(this).is(":checked"));
            });
            $('#checkOutrasCategoriasEdit').change(function (event) {
                $('#outrasCategoriasEdit').prop("disabled", !$(this).is(":checked"));
            });
        </script>

        <script type="text/javascript">
            function drop() {
                $(document).on("shown.bs.dropdown", ".dropdown", function () {
                    // calculate the required sizes, spaces
                    var $ul = $(this).children(".dropdown-menu");
                    var $button = $(this).children(".dropdown-toggle");
                    var ulOffset = $ul.offset();
                    // how much space would be left on the top if the dropdown opened that direction
                    var spaceUp = (ulOffset.top - $button.height() - $ul.height()) - $(window).scrollTop();
                    // how much space is left at the bottom
                    var spaceDown = $(window).scrollTop() + $(window).height() - (ulOffset.top + $ul.height());
                    // switch to dropup only if there is no space at the bottom AND there is space at the top, or there isn't either but it would be still better fit
                    if (spaceDown < 0 && (spaceUp >= 0 || spaceUp > spaceDown))
                        $(this).addClass("dropup");
                }).on("hidden.bs.dropdown", ".dropdown", function () {
                    // always reset after close
                    $(this).removeClass("dropup");
                });
            }
            var callback = function (mutationsList) {
                drop();
            };
            var config = {attributes: true, childList: true, subtree: true};
            var targetNode = document.getElementById('categorias');
            var observer = new MutationObserver(callback);
            observer.observe(targetNode, config);
        </script>
    </body>

</html>
